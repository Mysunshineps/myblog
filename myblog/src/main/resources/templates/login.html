<!DOCTYPE html>
<html>
<head>
<title>Signin</title>
<link href="css/style_login.css" rel='stylesheet' type='text/css' />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="App Sign in Form,Login Forms,Sign up Forms,Registration Forms,News latter Forms,Elements"./>
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
</script>
<!--webfonts-->
<link href='http://fonts.useso.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
<!--//webfonts-->
<script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>

</head>
<body>
	<h1>Welcome to you</h1>
		<div class="app-cam">
			<div class="cam"><img src="images/cam.png" class="img-responsive" alt="" /></div>
			<form>
				<input type="text" id="usernameId" class="text" name="username" value="用户名" onfocus="this.value = '';" onblur="if (this.value == '') {this.value = '请输入你的用户名';}" >
				<input type="password" id="passwordId" name="password"  onfocus="this.value = '';" onblur="if (this.value == '') {this.value = '请输入你的密码';}">
				<div class="submit"><input id="userlogin" type="button" value="Sign in" ></div>
				<div class="clear"></div>
				<div class="buttons">
					<ul>
						<li><a href="#" class="hvr-sweep-to-right">Sign in with Facebook</a></li>
						<li><a href="#" class="hvr-sweep-to-left">Sign in with Twitter</a></li>
						<div class="clear"></div>
					</ul>
				</div>
				<div class="new">
					<p><a href="#">Forgot Password ?</a></p>
					<p class="sign">New here ?<a onclick="register(this)" href="#"> Sign Up</a></p>
					<div class="clear"></div>
				</div>
			</form>
		</div>
	<!--start-copyright-->
   		<div class="copy-right">
				<p>Copyright &copy; 2015.Company name All rights reserved.<a target="_blank" href="http://www.cssmoban.com/">&#x7F51;&#x9875;&#x6A21;&#x677F;</a> - More Templates <a href="http://www.cssmoban.com/" target="_blank" title="模板之家">模板之家</a></p>
		</div>
	<!--//end-copyright-->
	
	
	
	<!-- 新加的函数:登陆认证到主页 -->
<script type="text/javascript">
	$(function(){
		$("#userlogin").click(doLogin);
	})
	//7.24ZT整合
	function doZtFind(){
		console.log("该方法执行了");
		var url="user/doFindUser";
		var params={username:$("#usernameId").val()};
		 $.post(url,params,function(result){
			setCookie("userId",result.data.id);//存userId存入Cookie中
			setCookie("username",result.data.username);//存username存入Cookie中
			  });

		}
	//1.整合
  function doLogin(){
		doZtFind();
	  var params={
		 username:$("#usernameId").val(),
		 password:$("#passwordId").val(),
	  }
	  var url="user/doLogin";
	  $.post(url,params,function(result){
		  if(result.state==1){
				//跳转到indexUI对应的页面
				alert(result.message)
				location.href="doindex?t="+Math.random();
			  }else{
				$(".login-box-msg").html(result.message); 
				alert("用户名或密码错误,请重新输入")
			  }
			  return false;//防止刷新时重复提交
		  });
	  }
	
	
	//2.整合
	function setCookie(name,value)
	{
	var Days = 30;
	var exp = new Date();
	exp.setTime(exp.getTime() + Days*24*60*60*1000);
	document.cookie = name + "="+ escape (value) + ";expires=" + exp.toGMTString();
	}
	
	
</script>

<script type="text/javascript">
	function register(a){
	window.location="doregister";
	}
</script>
</body>
</html>